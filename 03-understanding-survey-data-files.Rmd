# Understanding survey data files {#c03}

* [Loading survey file formats](#loading-survey-file-formats)
* [Working with labeled data](#working-with-labeled-data)

## Loading survey files into R

Survey files come in different file types depending on the program used to output them. R gives us the flexibility to load datasets regardless of their file extension. We will show how to load common survey file formats:

* Delimiter-separated text files
* Excel files
* `.dta` files from Stata
* `.sas` files from SAS

For less-common file formats, we recommend searching StackOverflow or similar community sites to learn how to import them into R.

### Best practices for loading data into R

We recommend a project-based workflow for analysis projects as described in Hadley Wickham and Garrett Grolemund's book, R for Data Science. Projects help us practice file system discipline, since we put all the files related to a single project in a designated folder. Since all associated files are in a single location, they are easy to find and organize.

The RStudio IDE supports project-based workflows. When we create a project in RStudio, it creates a `.Rproj` file that store settings specific to that project.

The {here} package enables easy file referencing. In a project-based workflow, all paths are relative and, by default, relative to the projectâ€™s folder.

Use the `here()` function from the here package to build the path when you load or save data.

### Loading delimiter-separated files into R

Delimiter-separated files use specific characters to separate values. For example, comma-separated values (CSV) files are separated by commas. These file types are widely used and we can use many applications to read and write them.

We can read delimiter-separated files using the tidyverse package {readr}. The {readr} package supports the following files with these `read_*()` functions:

* `read_csv()`: Comma-separated values (CSV) files
* `read_tsv()`: Tab-separated values (TSV) files
* `read_delim()`: Delimiter-separated files (CSV and TSV are important special cases)
* `read_fwf()`: Fixed-width files
* `read_table()`: Whitespace-separated files
* `read_log()`: Web log files

```{r, eval=FALSE}

```

### Loading Excel `.xlsx` files into R



### Loading Stata `.dta` files into R

Stata is a popular statistical software program for data manipulation, visualization, statistics, and automated reporting. Stata stores data in the proprietary `.dta` format. This file type can contain labels for variables and values.

The {haven} package from the tidyverse imports a variety of proprietary data formats, including Stata's `.dta` files, SAS's `.sas` files, and SPSS's `.sav` files. Once imported, we can analyze the resulting tibbles in R.

```{r}
haven::read_dta("https://www.stata-press.com/data/r17/smho.dta")
```

###  Loading SAS `.sas` files into R

SAS `.sas` files are similar to Stata `.dta` files. They are both proprietary file formats, contain labelled data, and can be imported using {haven}.

## Working with labeled data

We can use the `haven::labelled()` function to import labelled vectors into R. The goal is to create an intermediate object and then convert it into a regular R data frame to use in our analysis.

## Missing data

For Stata and SAS files, {haven} provides `tagged` missing values. A `tagged` missing value adds a single character label to R's regular `NA`.




Sources
- https://www.stata-press.com/data/r17/svy.html
