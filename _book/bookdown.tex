% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
]{krantz}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Tidy Survey Book},
  pdfauthor={Stephanie Zimmer, Rebecca Powell, and Isabella Velásquez},
  colorlinks=true,
  linkcolor={Maroon},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.33,0.33,0.33}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.61,0.61,0.61}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.06,0.06,0.06}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.5,0.5,0.5}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0,0,0}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.27,0.27,0.27}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.27,0.27,0.27}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.06,0.06,0.06}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.14,0.14,0.14}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.06,0.06,0.06}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0,0,0}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.27,0.27,0.27}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.43,0.43,0.43}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0,0,0}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.5,0.5,0.5}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.5,0.5,0.5}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0,0,0}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.5,0.5,0.5}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage[bf,singlelinecheck=off]{caption}
\captionsetup[table]{labelsep=space}
\captionsetup[figure]{labelsep=space}
\usepackage[scale=.8]{sourcecodepro}

\usepackage{framed,color}
\definecolor{shadecolor}{RGB}{248,248,248}

\renewcommand{\textfraction}{0.05}
\renewcommand{\topfraction}{0.8}
\renewcommand{\bottomfraction}{0.8}
\renewcommand{\floatpagefraction}{0.75}

\renewenvironment{quote}{\begin{VF}}{\end{VF}}
\let\oldhref\href
\renewcommand{\href}[2]{#2\footnote{\url{#1}}}

\makeatletter
\newenvironment{kframe}{%
\medskip{}
\setlength{\fboxsep}{.8em}
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\renewenvironment{Shaded}{\begin{kframe}}{\end{kframe}}

\usepackage{makeidx}
\makeindex

\urlstyle{tt}

\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother

\frontmatter
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}

\title{Tidy Survey Book}
\author{Stephanie Zimmer, Rebecca Powell, and Isabella Velásquez}
\date{2022-06-12}

\begin{document}
\maketitle

% you may need to leave a few empty pages before the dedication page

%\cleardoublepage\newpage\thispagestyle{empty}\null
%\cleardoublepage\newpage\thispagestyle{empty}\null
%\cleardoublepage\newpage
\thispagestyle{empty}

\begin{center}
To my son,

without whom I should have finished this book two years earlier
%\includegraphics{images/dedication.pdf}
\end{center}

\setlength{\abovedisplayskip}{-5pt}
\setlength{\abovedisplayshortskip}{-5pt}

{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\listoffigures
\listoftables
\hypertarget{preface}{%
\chapter*{Preface}\label{preface}}


Hi there, this is my great book.

\hypertarget{why-read-this-book}{%
\section*{Why read this book}\label{why-read-this-book}}


It is very important\ldots{}

\hypertarget{structure-of-the-book}{%
\section*{Structure of the book}\label{structure-of-the-book}}


Chapters \ref{introduction} introduces a new topic, and \ldots{}

\hypertarget{software-information-and-conventions}{%
\section*{Software information and conventions}\label{software-information-and-conventions}}


I used the \textbf{knitr}\index{knitr} package \citep{xie2015} and the \textbf{bookdown}\index{bookdown} package \citep{R-bookdown} to compile my book. My R session information is shown below:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{xfun}\SpecialCharTok{::}\FunctionTok{session\_info}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R version 4.1.2 (2021-11-01)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur 10.16
## 
## Locale: en_US.UTF-8 / en_US.UTF-8 / en_US.UTF-8 / C / en_US.UTF-8 / en_US.UTF-8
## 
## Package version:
##   base64enc_0.1.3 bookdown_0.26   bslib_0.3.1    
##   cli_3.3.0       compiler_4.1.2  digest_0.6.29  
##   evaluate_0.15   fastmap_1.1.0   fs_1.5.2       
##   glue_1.6.2      graphics_4.1.2  grDevices_4.1.2
##   highr_0.9       htmltools_0.5.2 jquerylib_0.1.4
##   jsonlite_1.8.0  knitr_1.39      magrittr_2.0.3 
##   methods_4.1.2   R6_2.5.1        rappdirs_0.3.3 
##   rlang_1.0.2     rmarkdown_2.14  rstudioapi_0.13
##   sass_0.4.1      stats_4.1.2     stringi_1.7.6  
##   stringr_1.4.0   tinytex_0.39    tools_4.1.2    
##   utils_4.1.2     xfun_0.31       yaml_2.3.5
\end{verbatim}

Package names are in bold text (e.g., \textbf{rmarkdown}), and inline code and filenames are formatted in a typewriter font (e.g., \texttt{knitr::knit(\textquotesingle{}foo.Rmd\textquotesingle{})}). Function names are followed by parentheses (e.g., \texttt{bookdown::render\_book()}).

\hypertarget{acknowledgments}{%
\section*{Acknowledgments}\label{acknowledgments}}


A lot of people helped me when I was writing the book.

\begin{flushright}
Frida Gomam\\
on the Mars
\end{flushright}

\mainmatter

\hypertarget{c01}{%
\chapter{Introduction}\label{c01}}

\hypertarget{c02}{%
\chapter{Introducing survey data}\label{c02}}

\hypertarget{c03}{%
\chapter{Understanding survey data files}\label{c03}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{loading-survey-file-formats}{Loading survey file formats}
\item
\end{itemize}

\hypertarget{loading-survey-files-into-r}{%
\section{Loading survey files into R}\label{loading-survey-files-into-r}}

Survey files come in different file types depending on the program used to output them. R gives us the flexibility to load datasets regardless of their file extension. We will cover the file types we are most likely to encounter in survey analysis: delimiter-separated text files, Excel files, \texttt{.dta} files from Stata, and \texttt{.sas} files from SAS.

\hypertarget{best-practices-for-loading-data-into-r}{%
\subsection{Best practices for loading data into R}\label{best-practices-for-loading-data-into-r}}

\hypertarget{loading-delimiter-separated-files-into-r}{%
\subsection{Loading delimiter-separated files into R}\label{loading-delimiter-separated-files-into-r}}

Delimiter-separated files use specific characters to separate values. For example, comma-separated values (CSV) files are separated by commas. These file types are widely used and we can use many applications to read and write them.

We can read delimiter-separated files using the tidyverse package \{readr\}. The \{readr\} package supports the following files with these \texttt{read\_*()} functions:

\begin{itemize}
\tightlist
\item
  \texttt{read\_csv()}: Comma-separated values (CSV) files
\item
  \texttt{read\_tsv()}: Tab-separated values (TSV) files
\item
  \texttt{read\_delim()}: Delimiter-separated files (CSV and TSV are important special cases)
\item
  \texttt{read\_fwf()}: Fixed-width files
\item
  \texttt{read\_table()}: Whitespace-separated files
\item
  \texttt{read\_log()}: Web log files
\end{itemize}

\hypertarget{loading-stata-.dta-files-into-r}{%
\subsection{\texorpdfstring{Loading Stata \texttt{.dta} files into R}{Loading Stata .dta files into R}}\label{loading-stata-.dta-files-into-r}}

Stata is a popular statistical software package for data manipulation, visualization, statistics, and automated reporting. Stata stores its data using the proprietary \texttt{.dta} format, a file type that can contain labels for the data's variables and values.

The \{haven\} package imports a variety of proprietary data formats, including Stata's \texttt{.dta} files, SAS's \texttt{.sas} files, and SPSS's \texttt{.sav} files. Once imported, we can analyze the resulting tibbles in R.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{haven}\SpecialCharTok{::}\FunctionTok{read\_dta}\NormalTok{(}\StringTok{"https://www.stata{-}press.com/data/r17/smho.dta"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 120 x 10
##       id        hosptype exptotal  beds seencnt eoycnt
##    <dbl>       <dbl+lbl>    <dbl> <dbl>   <dbl>  <dbl>
##  1    14 1 [Psychiatric]       18   138    3083    308
##  2    19 1 [Psychiatric]        6    72    1557     15
##  3    30 1 [Psychiatric]       10    79    1822    191
##  4    32 1 [Psychiatric]        4    15    1201      0
##  5    44 1 [Psychiatric]        2    31    1346      0
##  6    47 1 [Psychiatric]       10   139    1739    126
##  7    52 1 [Psychiatric]       15   169    2614      0
##  8    54 1 [Psychiatric]       15    96    1137     82
##  9    58 1 [Psychiatric]       10    83    1783    164
## 10    62 1 [Psychiatric]       10   178    1956    305
## # ... with 110 more rows, and 4 more variables:
## #   findirct <dbl>, wt <dbl>, stratum <dbl>, N_h <dbl>
\end{verbatim}

\hypertarget{loading-sas-.sas-files-into-r}{%
\subsection{\texorpdfstring{Loading SAS \texttt{.sas} files into R}{Loading SAS .sas files into R}}\label{loading-sas-.sas-files-into-r}}

Similar to the

\hypertarget{working-with-labelled-data}{%
\section{Working with labelled data}\label{working-with-labelled-data}}

We can use the \texttt{haven::labelled()} function to import labelled vectors into R. The goal is to create an intermediate object and then convert it into a regular R data frame to use in our analysis.

\hypertarget{missing-data}{%
\section{Missing data}\label{missing-data}}

For Stata and SAS, \{haven\} provides \texttt{tagged} missing values. This adds a single character label to R's regular \texttt{NA}.

Sources
- \url{https://www.stata-press.com/data/r17/svy.html}

\hypertarget{c04}{%
\chapter{Introducing the srvyr package}\label{c04}}

\hypertarget{c05}{%
\chapter{Specifying sample designs in srvyr}\label{c05}}

\hypertarget{c06}{%
\chapter{Descriptive analyses in srvyr}\label{c06}}

\hypertarget{c07}{%
\chapter{Statistical testing}\label{c07}}

\hypertarget{c08}{%
\chapter{Modeling}\label{c08}}

\hypertarget{c09}{%
\chapter{Presenting results}\label{c09}}

\cleardoublepage

\hypertarget{appendix-appendix}{%
\appendix \addcontentsline{toc}{chapter}{\appendixname}}


\hypertarget{more-to-say}{%
\chapter{More to Say}\label{more-to-say}}

Yeah! I have finished my book, but I have more to say about some topics. Let me explain them in this appendix.

To know more about \textbf{bookdown}, see \url{https://bookdown.org}.

  \bibliography{book.bib,packages.bib}

\backmatter
\printindex

\end{document}
